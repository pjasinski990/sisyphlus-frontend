@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400;600;700&display=swap');

@import 'tailwindcss';
@import './custom-scrollbar.css';

@plugin 'tailwind-scrollbar';

:root.dark { color-scheme: dark; }
:root:not(.dark) { color-scheme: light; }

@theme {
  /* Typography */
  --font-primary: 'Inter', sans-serif;
  --font-secondary: 'Fira Sans', sans-serif;
  --h1: 600 3rem/1.2em var(--font-secondary);
  --h2: 600 2rem/1.2em var(--font-secondary);
  --h3: 600 1.2rem/1.3em var(--font-secondary);
  --p: 1rem/1.5em var(--font-primary);
  --span: 1rem/1.0em var(--font-primary);

  /* Neutral ramp */
  --ink-10: oklch(0.98 0.01 260);
  --ink-20: oklch(0.95 0.01 260);
  --ink-30: oklch(0.90 0.01 260);
  --ink-40: oklch(0.84 0.01 260);
  --ink-50: oklch(0.75 0.02 260);
  --ink-60: oklch(0.62 0.03 260);
  --ink-70: oklch(0.50 0.03 260);
  --ink-80: oklch(0.40 0.03 260);
  --ink-90: oklch(0.30 0.03 260);
  --ink-100: oklch(0.22 0.03 260);

  /* Stone */
  --stone-1-light: oklch(0.92 0.06 240);
  --stone-1-dark: oklch(0.48 0.15 240);
  --stone-2-light: oklch(0.82 0.08 290);
  --stone-2-dark: oklch(0.42 0.20 290);
  --stone-3-light: oklch(0.80 0.10 160);
  --stone-3-dark: oklch(0.38 0.14 160);

  /* Brand accent ramp */
  --brand-10: oklch(0.97 0.03 85);
  --brand-30: oklch(0.90 0.07 85);
  --brand-50: oklch(0.82 0.11 85);
  --brand-70: oklch(0.74 0.14 85);
  --brand-90: oklch(0.66 0.15 85);

  /* Functional */
  --success-60: oklch(0.70 0.12 145);
  --warning-60: oklch(0.78 0.12 80);
  --danger-60:  oklch(0.66 0.16 28);

  /* Semantic */
  --bg: var(--ink-10);
  --surface-1: var(--ink-30);
  --surface-2: var(--ink-40);
  --surface-3: var(--ink-50);

  --text-1: var(--ink-100);
  --text-2: var(--ink-80);
  --text-reversed: var(--ink-10);
  --muted:  var(--ink-60);

  --focus:  var(--brand-70);

  --accent-low: var(--brand-50);
  --accent: var(--brand-90);
  --accent-high: var(--brand-90);
  --accent-contrast: var(--ink-100);

  --secondary-1: var(--stone-1-dark);
  --secondary-2: var(--stone-2-dark);
  --secondary-3: var(--stone-3-dark);

  --success: var(--success-60);
  --warning: var(--warning-60);
  --danger:  var(--danger-60);

  --surface-hover: color-mix(in oklab, var(--surface-1), black 10%);
  --surface-active: color-mix(in oklab, var(--surface-1), black 12%);

  /* App specific */
  --low-energy: oklch(70% 0.10 250);
  --medium-energy: oklch(70% 0.18 90);
  --high-energy: oklch(70% 0.20 25);
}

.dark {
  --bg: var(--ink-90);
  --surface-1: var(--ink-90);
  --surface-2: var(--ink-80);
  --surface-3: var(--ink-70);

  --text-1: var(--ink-10);
  --text-2: var(--ink-30);
  --text-reversed: var(--ink-90);
  --muted:  var(--ink-50);

  --border: oklch(0.36 0.02 260);
  --focus:  var(--brand-50);

  --accent-low: var(--brand-70);
  --accent: var(--brand-50);
  --accent-high: var(--brand-30);
  --accent-contrast: var(--ink-100);

  --secondary-1: var(--stone-1-light);
  --secondary-2: var(--stone-2-light);
  --secondary-3: var(--stone-3-light);

  --surface-hover: color-mix(in oklab, var(--surface-1), white 6%);
  --surface-active: color-mix(in oklab, var(--surface-1), white 8%);

  /* App specific */
  --low-energy: oklch(65% 0.10 250);
  --medium-energy: oklch(65% 0.14 90);
  --high-energy: oklch(65% 0.20 25);
}

/* Tailwind-facing aliases */
@theme {
  --color-ink-10: var(--ink-10);
  --color-ink-20: var(--ink-20);
  --color-ink-30: var(--ink-30);
  --color-ink-40: var(--ink-40);
  --color-ink-50: var(--ink-50);
  --color-ink-60: var(--ink-60);
  --color-ink-70: var(--ink-70);
  --color-ink-80: var(--ink-80);
  --color-ink-90: var(--ink-90);
  --color-ink-100: var(--ink-100);

  --color-brand-10: var(--brand-10);
  --color-brand-30: var(--brand-30);
  --color-brand-50: var(--brand-50);
  --color-brand-70: var(--brand-70);
  --color-brand-90: var(--brand-90);

  --color-success: var(--success);
  --color-warning: var(--warning);
  --color-danger: var(--danger);

  --color-bg: var(--bg);
  --color-surface-1: var(--surface-1);
  --color-surface-2: var(--surface-2);
  --color-surface-3: var(--surface-3);

  --color-secondary-1: var(--secondary-1);
  --color-secondary-2: var(--secondary-2);
  --color-secondary-3: var(--secondary-3);

  --color-text-1: var(--text-1);
  --color-text-2: var(--text-2);
  --color-text-reversed: var(--text-reversed);
  --color-muted: var(--muted);

  --color-border: var(--border);
  --color-focus: var(--focus);

  --color-accent: var(--accent);
  --color-accent-contrast: var(--accent-contrast);

  --color-surface-hover: var(--surface-hover);
  --color-surface-active: var(--surface-active);

  /* App specific */
  --color-low-energy: var(--low-energy);
  --color-medium-energy: var(--medium-energy);
  --color-high-energy: var(--high-energy);
}

@layer base {
  html {
    scroll-behavior: smooth;
    @apply bg-surface-1 text-1;
    transition: background-color 0.3s ease, color 0.1s ease;
  }

  body {
    text-wrap: balance;
    font: var(--p);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  h1 {
    font: var(--h1);
    @apply my-2;
  }

  h2 {
    font: var(--h2);
    @apply my-2;
  }

  h3 {
    font: var(--h3);
    @apply my-2;
  }

  p {
    @apply my-2;
    white-space: normal;
    word-break: break-word;
  }

  a {
    @apply text-ink-100 no-underline;
  }

  a:hover {
    @apply text-ink-30;
  }
}

@layer components {
}

@layer utilities {
  .paper-texture {
    &::before {
      content: '';
      position: absolute;
      inset: 0;

      background-image:
              repeating-linear-gradient(30deg, rgba(255,255,255,0.05) 0 2px, rgba(0,0,0,0.01) 2px 4px),
              radial-gradient(circle at 30% 35%, rgba(0,0,0,0.1) 0%, transparent 30%),
              radial-gradient(circle at 70% 65%, rgba(0,0,0,0.1) 0%, transparent 50%),
              url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCI+PGZpbHRlciBpZD0ibm9pc2VGaWx0ZXIiPjxmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIxIiBudWJPY3RhdmVzPSIzIiBzZWVkPSIyIi8+PGZlQ29sb3JNYXRyaXggdHlwZT0ic2F0dXJhdGUiIHZhbHVlcz0iMCIvPjwvZmlsdGVyPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbHRlcj0idXJsKCNub2lzZUZpbHRlcikiIG9wYWNpdHk9IjAuMDUiIC8+PC9zdmc+");
      background-size:
              100% 100%,
              100% 100%,
              200% 200%,
              50px 50px;

      mix-blend-mode: overlay;
      opacity: 0.8;
      pointer-events: none;
      z-index: 0;
    }
  }

  .stone-texture {
    position: relative;
    z-index: 0;

    border-radius: 0.5rem;
    overflow: hidden;

    border: 1px solid rgba(255, 255, 255, 0.08);
  }

  .stone-texture::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 0;

    background-image:
            radial-gradient(
                    circle at -10% -30%,
                    rgba(200, 200, 200, 0.2) 0%,
                    transparent 100%
            ),
            radial-gradient(
                    circle at 70% 70%,
                    rgba(0, 0, 0, 0.2) 0%,
                    transparent 50%
            ),
            radial-gradient(
                    circle at 120% 50%,
                    rgba(255, 255, 255, 0.4) 0%,
                    transparent 100%
            );

    background-size:
            200% 200%,
            200% 200%,
            200% 200%;

    mix-blend-mode: difference;
    opacity: 0.6;
  }

  .defined-shadow {
    box-shadow:
            0 4px 8px rgba(0, 0, 0, 0.2),
            0 1px 4px rgba(0, 0, 0, 0.3);
  }

  .brand-gradient {
    background: linear-gradient(
            90deg,
            var(--accent-high) 0%,
            var(--accent) 30%
    );
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .text-glow {
    text-shadow:
            0 0 3px oklch(from var(--brand-50) l c h / 0.5),
            0 0 5px oklch(from var(--brand-50) l c h / 0.3);
  }

  .hover-text-glow:hover {
    text-shadow:
            0 0 3px oklch(from var(--brand-50) l c h / 0.5),
            0 0 5px oklch(from var(--brand-50) l c h / 0.3);
  }

  :root { --btn-hi: black; }
  .dark { --btn-hi: white; }

  :root { --on-secondary-3: var(--ink-10); }
  .dark { --on-secondary-3: var(--ink-100); }

  :root { --btn-fg: white; }
  :root { --btn-bg: black; }

  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-sm px-3.5 py-2.5
    text-sm font-medium shadow-sm select-none cursor-pointer
    transition-[background,color,box-shadow,transform] duration-150;
  }

  .btn-solid {
    background: var(--btn-bg);
    color: var(--btn-fg);
  }

  .btn-solid:hover {
    background: color-mix(in oklab, var(--btn-bg), var(--btn-hi) 8%);
  }

  .btn-solid:active {
    background: color-mix(in oklab, var(--btn-bg), var(--btn-hi) 12%);
    transform: translateY(1px);
  }

  .btn:disabled, .btn.disabled {
    opacity: 0.5;
    pointer-events: none;
  }

  @keyframes flame-flicker {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
    25% { transform: scale(1.03) rotate(-2deg); opacity: 0.9; }
    50% { transform: scale(0.98) rotate(2deg); opacity: 1; }
    75% { transform: scale(1.05) rotate(-2deg); opacity: 0.95; }
  }

  .flame-flicker {
    animation: flame-flicker 0.4s infinite;
  }
}
